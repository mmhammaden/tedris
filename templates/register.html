{% extends "base.html" %}

{% block title %}التسجيل - تدريس{% endblock %}

{% block content %}
<div class="max-w-2xl mx-auto fade-in">
    <div class="bg-white rounded-xl shadow-lg p-8">
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-900 mb-2">إنشاء حساب جديد</h1>
            <p class="text-gray-600">املأ البيانات التالية للتسجيل في منصة تدريس</p>
        </div>
        
        <form method="POST" x-data="registrationForm()" class="space-y-6">
            <!-- Full Name -->
            <div>
                <label for="full_name" class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-user ml-2 text-primary-600"></i>
                    الاسم الكامل
                </label>
                <input type="text" 
                       id="full_name" 
                       name="full_name" 
                       x-model="form.fullName"
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                       placeholder="الاسم الكامل"
                       required>
            </div>
            
            <!-- NNI -->
            <div>
                <label for="nni" class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-id-card ml-2 text-primary-600"></i>
                    رقم التعريف الوطني (NNI)
                </label>
                <input type="text" 
                       id="nni" 
                       name="nni" 
                       x-model="form.nni"
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                       placeholder="رقم التعريف الوطني"
                       required>
            </div>
            
            <!-- Phone Number -->
            <div>
                <label for="phone" class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-phone ml-2 text-primary-600"></i>
                    رقم الهاتف
                </label>
                <input type="tel" 
                       id="phone" 
                       name="phone" 
                       x-model="form.phone"
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                       placeholder="مثال: 22123456"
                       maxlength="8"
                       required>
                <p class="text-xs text-gray-500 mt-1">يجب أن يكون 8 أرقام بين 22000000 و 49999999</p>
            </div>
            
            <!-- Password -->
            <div>
                <label for="password" class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-lock ml-2 text-primary-600"></i>
                    كلمة المرور
                </label>
                <input type="password" 
                       id="password" 
                       name="password" 
                       x-model="form.password"
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                       placeholder="كلمة المرور (6 أحرف على الأقل)"
                       minlength="6"
                       required>
            </div>
            
            <!-- Confirm Password -->
            <div>
                <label for="confirm_password" class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-check ml-2 text-primary-600"></i>
                    تأكيد كلمة المرور
                </label>
                <input type="password" 
                       id="confirm_password" 
                       name="confirm_password" 
                       x-model="form.confirmPassword"
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                       placeholder="أعد إدخال كلمة المرور"
                       required>
                <p x-show="form.password && form.confirmPassword && form.password !== form.confirmPassword" 
                   class="text-xs text-red-500 mt-1">
                    كلمات المرور غير متطابقة
                </p>
            </div>
            
            <!-- User Category -->
            <div>
                <label for="user_category" class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-users ml-2 text-primary-600"></i>
                    فئة المستخدم
                </label>
                <select id="user_category" 
                        name="user_category" 
                        x-model="form.userCategory"
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                        required>
                    <option value="">اختر فئة المستخدم</option>
                    <option value="طالب">طالب</option>
                    <option value="معلم">معلم</option>
                    <option value="أستاذ">أستاذ</option>
                    <option value="مدير مدرسة">مدير مدرسة</option>
                    <option value="مفتش تربوي">مفتش تربوي</option>
                    <option value="إداري">إداري</option>
                    <option value="ولي أمر">ولي أمر</option>
                </select>
            </div>
            
            <!-- Wilaya -->
            <div>
                <label for="wilaya" class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-map-marker-alt ml-2 text-primary-600"></i>
                    الولاية
                </label>
                <select id="wilaya" 
                        name="wilaya" 
                        x-model="form.wilaya"
                        @change="updateMoughataas()"
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                        required>
                    <option value="">اختر الولاية</option>
                    <option value="نواكشوط الشمالية">نواكشوط الشمالية</option>
                    <option value="نواكشوط الغربية">نواكشوط الغربية</option>
                    <option value="نواكشوط الجنوبية">نواكشوط الجنوبية</option>
                    <option value="الحوض الشرقي">الحوض الشرقي</option>
                    <option value="الحوض الغربي">الحوض الغربي</option>
                    <option value="العصابة">العصابة</option>
                    <option value="كوركول">كوركول</option>
                    <option value="البراكنة">البراكنة</option>
                    <option value="الترارزة">الترارزة</option>
                    <option value="آدرار">آدرار</option>
                    <option value="داخلت نواديبو">داخلت نواديبو</option>
                    <option value="تكانت">تكانت</option>
                    <option value="كيدي ماغا">كيدي ماغا</option>
                    <option value="إنشيري">إنشيري</option>
                    <option value="تيرس زمور">تيرس زمور</option>
                </select>
            </div>
            
            <!-- Moughataa -->
            <div x-show="form.wilaya">
                <label for="moughataa" class="block text-sm font-medium text-gray-700 mb-2">
                    <i class="fas fa-location-dot ml-2 text-primary-600"></i>
                    المقاطعة
                </label>
                <select id="moughataa" 
                        name="moughataa" 
                        x-model="form.moughataa"
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors"
                        required>
                    <option value="">اختر المقاطعة</option>
                    <template x-for="moughataa in moughataas" :key="moughataa">
                        <option :value="moughataa" x-text="moughataa"></option>
                    </template>
                </select>
            </div>
            
            <!-- Submit Button -->
            <div class="pt-6">
                <button type="submit" 
                        :disabled="form.password && form.confirmPassword && form.password !== form.confirmPassword"
                        class="w-full bg-primary-600 hover:bg-primary-700 disabled:bg-gray-300 text-white font-semibold py-4 px-6 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2">
                    <i class="fas fa-user-plus ml-2"></i>
                    إنشاء الحساب
                </button>
            </div>
        </form>
        
        <div class="text-center mt-6">
            <p class="text-gray-600">
                لديك حساب بالفعل؟ 
                <a href="{{ url_for('login') }}" class="text-primary-600 hover:text-primary-700 font-medium">
                    تسجيل الدخول
                </a>
            </p>
        </div>
    </div>
</div>

<script>
function registrationForm() {
    return {
        form: {
            fullName: '',
            nni: '',
            phone: '',
            password: '',
            confirmPassword: '',
            userCategory: '',
            wilaya: '',
            moughataa: ''
        },
        moughataas: [],
        
        updateMoughataas() {
            const wilayasMoughataas = {
                'نواكشوط الشمالية': ['تفرغ زينة', 'دار النعيم', 'توجونين'],
                'نواكشوط الغربية': ['كرفور', 'تيارت', 'الميناء'],
                'نواكشوط الجنوبية': ['الرياض', 'عرفات', 'الخير'],
                'الحوض الشرقي': ['النعمة', 'الباسكنو', 'فصاله', 'أمجريه الجديدة'],
                'الحوض الغربي': ['العيون', 'تمبدغه', 'كوبني', 'بوتلميت'],
                'العصابة': ['كيفه', 'العصابة', 'بركيول', 'قورو'],
                'كوركول': ['سيلبابي', 'مبوت', 'يارل', 'فولو فولبه'],
                'البراكنة': ['ألاك', 'بوكي', 'مال', 'مقطع لحجار', 'أفديرك'],
                'الترارزة': ['روصو', 'المذرذرة', 'بوتيليميت', 'كور ماصين'],
                'آدرار': ['أطار', 'شنقيط', 'وادان', 'أوجفت'],
                'داخلت نواديبو': ['نواديبو'],
                'تكانت': ['تيجكجه', 'تامشكط', 'بومديد', 'كنكوصه'],
                'كيدي ماغا': ['كيدي ماغا', 'جعوار', 'كوبني', 'نيملان'],
                'إنشيري': ['أكجوجت', 'بنشاب', 'زويرات'],
                'تيرس زمور': ['بير أم كرين', 'الكليبه', 'زويرات']
            };
            
            this.moughataas = wilayasMoughataas[this.form.wilaya] || [];
            this.form.moughataa = '';
        }
    }
}
</script>
{% endblock %}
